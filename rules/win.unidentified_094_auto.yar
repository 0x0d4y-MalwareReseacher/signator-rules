rule win_unidentified_094_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2022-11-21"
        version = "1"
        description = "Detects win.unidentified_094."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.unidentified_094"
        malpedia_rule_date = "20221118"
        malpedia_hash = "e0702e2e6d1d00da65c8a29a4ebacd0a4c59e1af"
        malpedia_version = "20221125"
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { 56 c7458039663866 c7458432373561 c7458864633662 }
            // n = 4, score = 100
            //   56                   | push                esi
            //   c7458039663866       | mov                 dword ptr [ebp - 0x80], 0x66386639
            //   c7458432373561       | mov                 dword ptr [ebp - 0x7c], 0x61353732
            //   c7458864633662       | mov                 dword ptr [ebp - 0x78], 0x62366364

        $sequence_1 = { 893d???????? ff15???????? 8bf0 85f6 7416 57 53 }
            // n = 7, score = 100
            //   893d????????         |                     
            //   ff15????????         |                     
            //   8bf0                 | mov                 esi, eax
            //   85f6                 | test                esi, esi
            //   7416                 | je                  0x18
            //   57                   | push                edi
            //   53                   | push                ebx

        $sequence_2 = { c745c165656435 c745c537646563 c745c939396530 c745cd36653639 c745d162663236 c745d562326662 c745d966353464 }
            // n = 7, score = 100
            //   c745c165656435       | mov                 dword ptr [ebp - 0x3f], 0x35646565
            //   c745c537646563       | mov                 dword ptr [ebp - 0x3b], 0x63656437
            //   c745c939396530       | mov                 dword ptr [ebp - 0x37], 0x30653939
            //   c745cd36653639       | mov                 dword ptr [ebp - 0x33], 0x39366536
            //   c745d162663236       | mov                 dword ptr [ebp - 0x2f], 0x36326662
            //   c745d562326662       | mov                 dword ptr [ebp - 0x2b], 0x62663262
            //   c745d966353464       | mov                 dword ptr [ebp - 0x27], 0x64343566

        $sequence_3 = { c74584bc90a0a7 c745885ea3b79c c7458ca3241ca8 c74590ace320b7 c7459436b41f5f c745988580f908 c7459cf616dc52 }
            // n = 7, score = 100
            //   c74584bc90a0a7       | mov                 dword ptr [ebp - 0x7c], 0xa7a090bc
            //   c745885ea3b79c       | mov                 dword ptr [ebp - 0x78], 0x9cb7a35e
            //   c7458ca3241ca8       | mov                 dword ptr [ebp - 0x74], 0xa81c24a3
            //   c74590ace320b7       | mov                 dword ptr [ebp - 0x70], 0xb720e3ac
            //   c7459436b41f5f       | mov                 dword ptr [ebp - 0x6c], 0x5f1fb436
            //   c745988580f908       | mov                 dword ptr [ebp - 0x68], 0x8f98085
            //   c7459cf616dc52       | mov                 dword ptr [ebp - 0x64], 0x52dc16f6

        $sequence_4 = { 83c310 ff4d0c 0f857ffeffff 5f }
            // n = 4, score = 100
            //   83c310               | add                 ebx, 0x10
            //   ff4d0c               | dec                 dword ptr [ebp + 0xc]
            //   0f857ffeffff         | jne                 0xfffffe85
            //   5f                   | pop                 edi

        $sequence_5 = { c74584c3789c17 c74588d22bc5df c7458ca6a4cd0e c745901c5acb51 c74594f82dde15 c745984cd4d277 c7459c4aca178f }
            // n = 7, score = 100
            //   c74584c3789c17       | mov                 dword ptr [ebp - 0x7c], 0x179c78c3
            //   c74588d22bc5df       | mov                 dword ptr [ebp - 0x78], 0xdfc52bd2
            //   c7458ca6a4cd0e       | mov                 dword ptr [ebp - 0x74], 0xecda4a6
            //   c745901c5acb51       | mov                 dword ptr [ebp - 0x70], 0x51cb5a1c
            //   c74594f82dde15       | mov                 dword ptr [ebp - 0x6c], 0x15de2df8
            //   c745984cd4d277       | mov                 dword ptr [ebp - 0x68], 0x77d2d44c
            //   c7459c4aca178f       | mov                 dword ptr [ebp - 0x64], 0x8f17ca4a

        $sequence_6 = { 6a20 8d4d80 51 56 c745800dcc5be1 }
            // n = 5, score = 100
            //   6a20                 | push                0x20
            //   8d4d80               | lea                 ecx, [ebp - 0x80]
            //   51                   | push                ecx
            //   56                   | push                esi
            //   c745800dcc5be1       | mov                 dword ptr [ebp - 0x80], 0xe15bcc0d

        $sequence_7 = { c745844fed1a18 c745883074efdd c7458c56f512e7 c74590a89f715d c74594ad07908a c7459822804025 }
            // n = 6, score = 100
            //   c745844fed1a18       | mov                 dword ptr [ebp - 0x7c], 0x181aed4f
            //   c745883074efdd       | mov                 dword ptr [ebp - 0x78], 0xddef7430
            //   c7458c56f512e7       | mov                 dword ptr [ebp - 0x74], 0xe712f556
            //   c74590a89f715d       | mov                 dword ptr [ebp - 0x70], 0x5d719fa8
            //   c74594ad07908a       | mov                 dword ptr [ebp - 0x6c], 0x8a9007ad
            //   c7459822804025       | mov                 dword ptr [ebp - 0x68], 0x25408022

        $sequence_8 = { c74588f5fed946 c7458c4fef03ac c745902f8295f9 c7459487f60372 c7459874d7d57d c7459cac355c5a c745a039663866 }
            // n = 7, score = 100
            //   c74588f5fed946       | mov                 dword ptr [ebp - 0x78], 0x46d9fef5
            //   c7458c4fef03ac       | mov                 dword ptr [ebp - 0x74], 0xac03ef4f
            //   c745902f8295f9       | mov                 dword ptr [ebp - 0x70], 0xf995822f
            //   c7459487f60372       | mov                 dword ptr [ebp - 0x6c], 0x7203f687
            //   c7459874d7d57d       | mov                 dword ptr [ebp - 0x68], 0x7dd5d774
            //   c7459cac355c5a       | mov                 dword ptr [ebp - 0x64], 0x5a5c35ac
            //   c745a039663866       | mov                 dword ptr [ebp - 0x60], 0x66386639

        $sequence_9 = { c745e0a909577e c745e483e4cdb9 c745e8e2d2f198 c745ecea570177 c70020000000 }
            // n = 5, score = 100
            //   c745e0a909577e       | mov                 dword ptr [ebp - 0x20], 0x7e5709a9
            //   c745e483e4cdb9       | mov                 dword ptr [ebp - 0x1c], 0xb9cde483
            //   c745e8e2d2f198       | mov                 dword ptr [ebp - 0x18], 0x98f1d2e2
            //   c745ecea570177       | mov                 dword ptr [ebp - 0x14], 0x770157ea
            //   c70020000000         | mov                 dword ptr [eax], 0x20

    condition:
        7 of them and filesize < 231424
}