rule win_neutrino_pos_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2022-11-21"
        version = "1"
        description = "Detects win.neutrino_pos."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.neutrino_pos"
        malpedia_rule_date = "20221118"
        malpedia_hash = "e0702e2e6d1d00da65c8a29a4ebacd0a4c59e1af"
        malpedia_version = "20221125"
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { 53 53 ff75fc 6a01 ff750c ff7508 ffd0 }
            // n = 7, score = 200
            //   53                   | push                ebx
            //   53                   | push                ebx
            //   ff75fc               | push                dword ptr [ebp - 4]
            //   6a01                 | push                1
            //   ff750c               | push                dword ptr [ebp + 0xc]
            //   ff7508               | push                dword ptr [ebp + 8]
            //   ffd0                 | call                eax

        $sequence_1 = { 58 6a07 66898554ffffff 58 8bc8 66898d56ffffff }
            // n = 6, score = 200
            //   58                   | pop                 eax
            //   6a07                 | push                7
            //   66898554ffffff       | mov                 word ptr [ebp - 0xac], ax
            //   58                   | pop                 eax
            //   8bc8                 | mov                 ecx, eax
            //   66898d56ffffff       | mov                 word ptr [ebp - 0xaa], cx

        $sequence_2 = { 81ec44030000 53 56 57 c78590feffff72746275 c78594feffff34352963 }
            // n = 6, score = 200
            //   81ec44030000         | sub                 esp, 0x344
            //   53                   | push                ebx
            //   56                   | push                esi
            //   57                   | push                edi
            //   c78590feffff72746275     | mov    dword ptr [ebp - 0x170], 0x75627472
            //   c78594feffff34352963     | mov    dword ptr [ebp - 0x16c], 0x63293534

        $sequence_3 = { 5b 6a74 66899d7cffffff 5b 66899d7effffff 6a44 8bda }
            // n = 7, score = 200
            //   5b                   | pop                 ebx
            //   6a74                 | push                0x74
            //   66899d7cffffff       | mov                 word ptr [ebp - 0x84], bx
            //   5b                   | pop                 ebx
            //   66899d7effffff       | mov                 word ptr [ebp - 0x82], bx
            //   6a44                 | push                0x44
            //   8bda                 | mov                 ebx, edx

        $sequence_4 = { 66899572ffffff 5a 6a69 66899574ffffff 5a 6a63 8bfa }
            // n = 7, score = 200
            //   66899572ffffff       | mov                 word ptr [ebp - 0x8e], dx
            //   5a                   | pop                 edx
            //   6a69                 | push                0x69
            //   66899574ffffff       | mov                 word ptr [ebp - 0x8c], dx
            //   5a                   | pop                 edx
            //   6a63                 | push                0x63
            //   8bfa                 | mov                 edi, edx

        $sequence_5 = { 50 66894d8e 66894d90 66894d92 66894d94 66894d96 66894d98 }
            // n = 7, score = 200
            //   50                   | push                eax
            //   66894d8e             | mov                 word ptr [ebp - 0x72], cx
            //   66894d90             | mov                 word ptr [ebp - 0x70], cx
            //   66894d92             | mov                 word ptr [ebp - 0x6e], cx
            //   66894d94             | mov                 word ptr [ebp - 0x6c], cx
            //   66894d96             | mov                 word ptr [ebp - 0x6a], cx
            //   66894d98             | mov                 word ptr [ebp - 0x68], cx

        $sequence_6 = { c785dcfdffff3529636b c785e0fdffff6b070707 c785e4fdffff07070707 c785e8fdffff07070707 c785ecfdffff07070707 c785f0fdffff07070707 }
            // n = 6, score = 200
            //   c785dcfdffff3529636b     | mov    dword ptr [ebp - 0x224], 0x6b632935
            //   c785e0fdffff6b070707     | mov    dword ptr [ebp - 0x220], 0x707076b
            //   c785e4fdffff07070707     | mov    dword ptr [ebp - 0x21c], 0x7070707
            //   c785e8fdffff07070707     | mov    dword ptr [ebp - 0x218], 0x7070707
            //   c785ecfdffff07070707     | mov    dword ptr [ebp - 0x214], 0x7070707
            //   c785f0fdffff07070707     | mov    dword ptr [ebp - 0x210], 0x7070707

        $sequence_7 = { 5e 6a6e 66897596 5e 6a69 66897598 8bf1 }
            // n = 7, score = 200
            //   5e                   | pop                 esi
            //   6a6e                 | push                0x6e
            //   66897596             | mov                 word ptr [ebp - 0x6a], si
            //   5e                   | pop                 esi
            //   6a69                 | push                0x69
            //   66897598             | mov                 word ptr [ebp - 0x68], si
            //   8bf1                 | mov                 esi, ecx

        $sequence_8 = { 59 8d4dfc 51 56 6a00 ff750c ff7508 }
            // n = 7, score = 200
            //   59                   | pop                 ecx
            //   8d4dfc               | lea                 ecx, [ebp - 4]
            //   51                   | push                ecx
            //   56                   | push                esi
            //   6a00                 | push                0
            //   ff750c               | push                dword ptr [ebp + 0xc]
            //   ff7508               | push                dword ptr [ebp + 8]

        $sequence_9 = { 58 6a54 66898552ffffff 58 6a72 66898554ffffff }
            // n = 6, score = 200
            //   58                   | pop                 eax
            //   6a54                 | push                0x54
            //   66898552ffffff       | mov                 word ptr [ebp - 0xae], ax
            //   58                   | pop                 eax
            //   6a72                 | push                0x72
            //   66898554ffffff       | mov                 word ptr [ebp - 0xac], ax

    condition:
        7 of them and filesize < 188416
}