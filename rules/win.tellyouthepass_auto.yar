rule win_tellyouthepass_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2022-08-05"
        version = "1"
        description = "Detects win.tellyouthepass."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.tellyouthepass"
        malpedia_rule_date = "20220805"
        malpedia_hash = "6ec06c64bcfdbeda64eff021c766b4ce34542b71"
        malpedia_version = "20220808"
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { e8???????? 488b442428 e8???????? 488d05ee551900 bb0a000000 e8???????? }
            // n = 6, score = 100
            //   e8????????           |                     
            //   488b442428           | dec                 eax
            //   e8????????           |                     
            //   488d05ee551900       | lea                 ecx, [0x10dcfd]
            //   bb0a000000           | mov                 edi, 0xf
            //   e8????????           |                     

        $sequence_1 = { 90 e9???????? 4c8b9c24e0000000 4c8ba424e8000000 4180f8e2 0f85ac050000 4f8d1c39 }
            // n = 7, score = 100
            //   90                   | mov                 ecx, ebx
            //   e9????????           |                     
            //   4c8b9c24e0000000     | dec                 eax
            //   4c8ba424e8000000     | mov                 ebp, dword ptr [esp + 0xb0]
            //   4180f8e2             | dec                 eax
            //   0f85ac050000         | lea                 eax, [0x6d6e3]
            //   4f8d1c39             | nop                 dword ptr [eax]

        $sequence_2 = { 4c89e6 488d05f3550e00 4c89c9 e8???????? 488b5c2478 4c8b4c2460 4c8b5c2448 }
            // n = 7, score = 100
            //   4c89e6               | dec                 esp
            //   488d05f3550e00       | mov                 dword ptr [esp + 0x20], eax
            //   4c89c9               | dec                 eax
            //   e8????????           |                     
            //   488b5c2478           | lea                 eax, [0x590ac]
            //   4c8b4c2460           | dec                 eax
            //   4c8b5c2448           | mov                 ebx, dword ptr [esp + 0x110]

        $sequence_3 = { 7509 488905???????? eb0c 488d3d36162800 e8???????? 488b0d???????? 48898c2488020000 }
            // n = 7, score = 100
            //   7509                 | test                ecx, ecx
            //   488905????????       |                     
            //   eb0c                 | je                  0x455
            //   488d3d36162800       | dec                 eax
            //   e8????????           |                     
            //   488b0d????????       |                     
            //   48898c2488020000     | mov                 dword ptr [esp + 0x68], ecx

        $sequence_4 = { b801000000 488d0ddf592c00 8701 e8???????? 84c0 75be b8e8030000 }
            // n = 7, score = 100
            //   b801000000           | mov                 ebx, 0x15
            //   488d0ddf592c00       | dec                 eax
            //   8701                 | lea                 eax, [0x17e57d]
            //   e8????????           |                     
            //   84c0                 | dec                 eax
            //   75be                 | lea                 eax, [0x2f93f8]
            //   b8e8030000           | nop                 

        $sequence_5 = { c682f900000000 488b842478010000 bb04000000 b902000000 6690 e8???????? 803d????????00 }
            // n = 7, score = 100
            //   c682f900000000       | lea                 ecx, [0x13f4ab]
            //   488b842478010000     | dec                 eax
            //   bb04000000           | mov                 dword ptr [eax + 8], ecx
            //   b902000000           | dec                 eax
            //   6690                 | lea                 edi, [eax + 0x18]
            //   e8????????           |                     
            //   803d????????00       |                     

        $sequence_6 = { 84c9 751d 4889442440 8974242c 31db e8???????? 84c0 }
            // n = 7, score = 100
            //   84c9                 | lea                 ebx, [0x18afb1]
            //   751d                 | dec                 eax
            //   4889442440           | lea                 eax, [0x95147]
            //   8974242c             | dec                 eax
            //   31db                 | mov                 ebx, dword ptr [esp + 0x190]
            //   e8????????           |                     
            //   84c0                 | dec                 eax

        $sequence_7 = { bb17000000 e8???????? 488b5c2440 31c9 0fb67c2427 488b742438 4c8d05b8c10f00 }
            // n = 7, score = 100
            //   bb17000000           | lea                 ecx, [0x140296]
            //   e8????????           |                     
            //   488b5c2440           | mov                 edi, 0xc
            //   31c9                 | dec                 eax
            //   0fb67c2427           | lea                 edi, [0x26937d]
            //   488b742438           | dec                 eax
            //   4c8d05b8c10f00       | mov                 dword ptr [esp + 0x60], ecx

        $sequence_8 = { 48c741101c000000 833d????????00 750d 488d15b2750600 48895108 eb10 488d7908 }
            // n = 7, score = 100
            //   48c741101c000000     | mov                 ebx, dword ptr [esp + 0x310]
            //   833d????????00       |                     
            //   750d                 | dec                 eax
            //   488d15b2750600       | mov                 eax, dword ptr [esp + 0x308]
            //   48895108             | xor                 ecx, ecx
            //   eb10                 | dec                 eax
            //   488d7908             | mov                 dword ptr [esp + 0x110], edx

        $sequence_9 = { 48c705????????00000000 eb0e 488d3dc8422c00 31c0 e8???????? 488b6c2448 4883c450 }
            // n = 7, score = 100
            //   48c705????????00000000     |     
            //   eb0e                 | dec                 esp
            //   488d3dc8422c00       | mov                 dword ptr [esp + 0x78], edx
            //   31c0                 | dec                 esp
            //   e8????????           |                     
            //   488b6c2448           | mov                 dword ptr [esp + 0x60], ecx
            //   4883c450             | dec                 esp

    condition:
        7 of them and filesize < 7152640
}