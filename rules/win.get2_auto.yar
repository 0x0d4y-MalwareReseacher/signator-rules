rule win_get2_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2022-04-08"
        version = "1"
        description = "Describes win.get2."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.get2"
        malpedia_rule_date = "20220405"
        malpedia_hash = "ecd38294bd47d5589be5cd5490dc8bb4804afc2a"
        malpedia_version = ""
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { 8d44240c 68???????? 50 eb69 f6c102 8d4c2404 742b }
            // n = 7, score = 1000
            //   8d44240c             | lea                 eax, dword ptr [esp + 0xc]
            //   68????????           |                     
            //   50                   | push                eax
            //   eb69                 | jmp                 0x6b
            //   f6c102               | test                cl, 2
            //   8d4c2404             | lea                 ecx, dword ptr [esp + 4]
            //   742b                 | je                  0x2d

        $sequence_1 = { 8b01 8b4004 f644080c06 74d5 8d4d84 e8???????? }
            // n = 6, score = 1000
            //   8b01                 | mov                 eax, dword ptr [ecx]
            //   8b4004               | mov                 eax, dword ptr [eax + 4]
            //   f644080c06           | test                byte ptr [eax + ecx + 0xc], 6
            //   74d5                 | je                  0xffffffd7
            //   8d4d84               | lea                 ecx, dword ptr [ebp - 0x7c]
            //   e8????????           |                     

        $sequence_2 = { 43 897de8 33c0 895dd4 }
            // n = 4, score = 1000
            //   43                   | inc                 ebx
            //   897de8               | mov                 dword ptr [ebp - 0x18], edi
            //   33c0                 | xor                 eax, eax
            //   895dd4               | mov                 dword ptr [ebp - 0x2c], ebx

        $sequence_3 = { 7430 8d4c2404 e8???????? 8d4c240c ff7004 ff30 }
            // n = 6, score = 1000
            //   7430                 | je                  0x32
            //   8d4c2404             | lea                 ecx, dword ptr [esp + 4]
            //   e8????????           |                     
            //   8d4c240c             | lea                 ecx, dword ptr [esp + 0xc]
            //   ff7004               | push                dword ptr [eax + 4]
            //   ff30                 | push                dword ptr [eax]

        $sequence_4 = { 52 8d8d24ffffff 895dfc e8???????? c645fc02 eb0b 8d45d8 }
            // n = 7, score = 1000
            //   52                   | push                edx
            //   8d8d24ffffff         | lea                 ecx, dword ptr [ebp - 0xdc]
            //   895dfc               | mov                 dword ptr [ebp - 4], ebx
            //   e8????????           |                     
            //   c645fc02             | mov                 byte ptr [ebp - 4], 2
            //   eb0b                 | jmp                 0xd
            //   8d45d8               | lea                 eax, dword ptr [ebp - 0x28]

        $sequence_5 = { f20f590d???????? f20f5ec8 f20f110c24 ffd2 59 }
            // n = 5, score = 1000
            //   f20f590d????????     |                     
            //   f20f5ec8             | divsd               xmm1, xmm0
            //   f20f110c24           | movsd               qword ptr [esp], xmm1
            //   ffd2                 | call                edx
            //   59                   | pop                 ecx

        $sequence_6 = { 8bf1 8975d0 33ff 8975cc }
            // n = 4, score = 1000
            //   8bf1                 | mov                 esi, ecx
            //   8975d0               | mov                 dword ptr [ebp - 0x30], esi
            //   33ff                 | xor                 edi, edi
            //   8975cc               | mov                 dword ptr [ebp - 0x34], esi

        $sequence_7 = { c20400 6a38 b8???????? e8???????? 8bf1 8975bc 8b4508 }
            // n = 7, score = 1000
            //   c20400               | ret                 4
            //   6a38                 | push                0x38
            //   b8????????           |                     
            //   e8????????           |                     
            //   8bf1                 | mov                 esi, ecx
            //   8975bc               | mov                 dword ptr [ebp - 0x44], esi
            //   8b4508               | mov                 eax, dword ptr [ebp + 8]

        $sequence_8 = { 4883ec20 488d052b130200 488bd9 488901 }
            // n = 4, score = 100
            //   4883ec20             | je                  0x53
            //   488d052b130200       | dec                 eax
            //   488bd9               | sub                 esp, 0x20
            //   488901               | dec                 eax

        $sequence_9 = { 763b 498b86e0010000 4d8d86d0010000 4983781808 7203 }
            // n = 5, score = 100
            //   763b                 | dec                 eax
            //   498b86e0010000       | mov                 ecx, ebx
            //   4d8d86d0010000       | inc                 ebp
            //   4983781808           | xor                 esi, esi
            //   7203                 | jmp                 0x15

        $sequence_10 = { 488d05cc750100 483be8 7c81 85ff 7553 }
            // n = 5, score = 100
            //   488d05cc750100       | jbe                 0x3d
            //   483be8               | dec                 ecx
            //   7c81                 | mov                 eax, dword ptr [esi + 0x1e0]
            //   85ff                 | dec                 ebp
            //   7553                 | lea                 eax, dword ptr [esi + 0x1d0]

        $sequence_11 = { 488bcb e8???????? 4c63e0 85c0 0f88c9000000 488b542458 }
            // n = 6, score = 100
            //   488bcb               | dec                 ecx
            //   e8????????           |                     
            //   4c63e0               | or                  esi, 0xffffffff
            //   85c0                 | nop                 
            //   0f88c9000000         | dec                 ecx
            //   488b542458           | inc                 esi

        $sequence_12 = { 488d1522e90100 488bcb 488905???????? ff15???????? 483305???????? }
            // n = 5, score = 100
            //   488d1522e90100       | lea                 eax, dword ptr [0x2132b]
            //   488bcb               | dec                 eax
            //   488905????????       |                     
            //   ff15????????         |                     
            //   483305????????       |                     

        $sequence_13 = { 750b 4883c102 8bc5 48890e }
            // n = 4, score = 100
            //   750b                 | dec                 ecx
            //   4883c102             | cmp                 dword ptr [eax + 0x18], 8
            //   8bc5                 | jb                  0x18
            //   48890e               | dec                 eax

        $sequence_14 = { 33d2 b9e9fd0000 4889442420 ff15???????? 85c0 7451 }
            // n = 6, score = 100
            //   33d2                 | xor                 edx, edx
            //   b9e9fd0000           | mov                 ecx, 0xfde9
            //   4889442420           | dec                 eax
            //   ff15????????         |                     
            //   85c0                 | mov                 dword ptr [esp + 0x20], eax
            //   7451                 | test                eax, eax

        $sequence_15 = { 4533f6 eb10 4983ceff 6690 49ffc6 }
            // n = 5, score = 100
            //   4533f6               | mov                 ebx, ecx
            //   eb10                 | dec                 eax
            //   4983ceff             | mov                 dword ptr [ecx], eax
            //   6690                 | dec                 eax
            //   49ffc6               | lea                 edx, dword ptr [0x1e922]

    condition:
        7 of them and filesize < 720896
}