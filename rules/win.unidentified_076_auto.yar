rule win_unidentified_076_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2023-07-11"
        version = "1"
        description = "Detects win.unidentified_076."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.unidentified_076"
        malpedia_rule_date = "20230705"
        malpedia_hash = "42d0574f4405bd7d2b154d321d345acb18834a41"
        malpedia_version = "20230715"
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { 488b4618 48897858 488b4618 48894050 488b4e18 4863414c 4803c1 }
            // n = 7, score = 100
            //   488b4618             | mov                 eax, eax
            //   48897858             | mov                 dword ptr [esp + 0x28], 1
            //   488b4618             | mov                 dword ptr [esp + 0x20], 0x400
            //   48894050             | xor                 esi, esi
            //   488b4e18             | dec                 eax
            //   4863414c             | mov                 ecx, edi
            //   4803c1               | inc                 esp

        $sequence_1 = { 498bd7 89442428 895c2420 41ff9240030000 85c0 7926 }
            // n = 6, score = 100
            //   498bd7               | mov                 ecx, ebx
            //   89442428             | jmp                 0x8c7
            //   895c2420             | inc                 ecx
            //   41ff9240030000       | cmp                 eax, 0x2c
            //   85c0                 | jae                 0x856
            //   7926                 | inc                 ecx

        $sequence_2 = { 483b3f 75d4 488dbb88000000 eb27 488b17 488b0a }
            // n = 6, score = 100
            //   483b3f               | mov                 edi, ecx
            //   75d4                 | dec                 ecx
            //   488dbb88000000       | mov                 edi, eax
            //   eb27                 | dec                 eax
            //   488b17               | mov                 ebp, ecx
            //   488b0a               | dec                 ebp

        $sequence_3 = { 8bef e9???????? 4180ff51 0f8541010000 }
            // n = 4, score = 100
            //   8bef                 | call                dword ptr [edx + 0x180]
            //   e9????????           |                     
            //   4180ff51             | inc                 ebx
            //   0f8541010000         | dec                 eax

        $sequence_4 = { 443be3 0f8c3effffff 33c0 488b5c2450 488b6c2458 }
            // n = 5, score = 100
            //   443be3               | add                 eax, 0x1370
            //   0f8c3effffff         | dec                 eax
            //   33c0                 | mov                 edx, ebx
            //   488b5c2450           | mov                 dword ptr [esp + 0x30], edx
            //   488b6c2458           | dec                 eax

        $sequence_5 = { 488b87c8000000 8b9068050000 ebb6 4c8b06 488b8f68020000 41b900008000 ba0e660000 }
            // n = 7, score = 100
            //   488b87c8000000       | dec                 eax
            //   8b9068050000         | lea                 edx, [0x7085]
            //   ebb6                 | dec                 eax
            //   4c8b06               | lea                 ecx, [ebp + 0xa90]
            //   488b8f68020000       | dec                 eax
            //   41b900008000         | lea                 edx, [0x7192]
            //   ba0e660000           | dec                 eax

        $sequence_6 = { 0f85ab000000 4533ff 4c8bf7 8d7001 4885ff 0f84af000000 4183ff14 }
            // n = 7, score = 100
            //   0f85ab000000         | call                dword ptr [eax]
            //   4533ff               | dec                 eax
            //   4c8bf7               | mov                 esi, eax
            //   8d7001               | inc                 esp
            //   4885ff               | lea                 ecx, [edi + 0x18]
            //   0f84af000000         | inc                 ebp
            //   4183ff14             | xor                 eax, eax

        $sequence_7 = { 448b434c 443b4374 7837 b9581b0000 394b78 }
            // n = 5, score = 100
            //   448b434c             | mov                 dword ptr [ebx + 0xf4], esi
            //   443b4374             | mov                 dword ptr [ebx + 0x24], 2
            //   7837                 | dec                 eax
            //   b9581b0000           | mov                 dword ptr [ebx + 0xe8], esi
            //   394b78               | mov                 dword ptr [ebx + 0x7c], 0x14

        $sequence_8 = { 4885ff 7472 488b86c8000000 33d2 488bcf 448d4220 ff9020070000 }
            // n = 7, score = 100
            //   4885ff               | dec                 eax
            //   7472                 | mov                 edx, dword ptr [esi + 0x1348]
            //   488b86c8000000       | dec                 esp
            //   33d2                 | mov                 eax, dword ptr [esi + 0xc8]
            //   488bcf               | dec                 eax
            //   448d4220             | add                 ecx, 0x214
            //   ff9020070000         | dec                 eax

        $sequence_9 = { 488bcb e8???????? 488bcb e8???????? 488bcb 85c0 751e }
            // n = 7, score = 100
            //   488bcb               | xor                 edx, edx
            //   e8????????           |                     
            //   488bcb               | dec                 eax
            //   e8????????           |                     
            //   488bcb               | lea                 ecx, [edi + 0x6c8]
            //   85c0                 | mov                 edx, 0x1f7
            //   751e                 | call                dword ptr [eax + 0x7f0]

    condition:
        7 of them and filesize < 114688
}