rule win_noxplayer_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2022-08-05"
        version = "1"
        description = "Detects win.noxplayer."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.noxplayer"
        malpedia_rule_date = "20220805"
        malpedia_hash = "6ec06c64bcfdbeda64eff021c766b4ce34542b71"
        malpedia_version = "20220808"
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { 488bcf ff15???????? 894564 83f8ff 0f8436020000 33c0 48894568 }
            // n = 7, score = 100
            //   488bcf               | dec                 esp
            //   ff15????????         |                     
            //   894564               | lea                 eax, [ebp - 0x45]
            //   83f8ff               | dec                 eax
            //   0f8436020000         | lea                 edx, [ebp - 0x11]
            //   33c0                 | mov                 dword ptr [ebp - 0x45], eax
            //   48894568             | dec                 ebx

        $sequence_1 = { e8???????? 488b08 48890e 488b7c2460 4c8b742468 488b5c2470 488bc6 }
            // n = 7, score = 100
            //   e8????????           |                     
            //   488b08               | dec                 eax
            //   48890e               | mov                 ecx, dword ptr [eax + 0x18]
            //   488b7c2460           | dec                 eax
            //   4c8b742468           | mov                 eax, ebp
            //   488b5c2470           | dec                 eax
            //   488bc6               | mov                 dword ptr [ebp + 0x18], ecx

        $sequence_2 = { c1c20a 4103d0 0bc2 4133c0 4103c5 448d8c087df4efff 418bc0 }
            // n = 7, score = 100
            //   c1c20a               | mov                 dword ptr [eax + 8], eax
            //   4103d0               | dec                 eax
            //   0bc2                 | mov                 eax, dword ptr [ebx + 8]
            //   4133c0               | dec                 eax
            //   4103c5               | mov                 dword ptr [eax + 0x10], eax
            //   448d8c087df4efff     | dec                 eax
            //   418bc0               | mov                 eax, dword ptr [ebx + 8]

        $sequence_3 = { 488d4c2420 48c744245800000000 e8???????? 4c8d1d3b330300 488d155cfb0300 488d4c2420 4c895c2420 }
            // n = 7, score = 100
            //   488d4c2420           | add                 dword ptr [ebx + 0x178], eax
            //   48c744245800000000     | mov    eax, dword ptr [ebx + 0x1b4]
            //   e8????????           |                     
            //   4c8d1d3b330300       | add                 dword ptr [ebx + 0x17c], eax
            //   488d155cfb0300       | mov                 eax, dword ptr [ebx + 0x1b8]
            //   488d4c2420           | add                 dword ptr [ebx + 0x180], eax
            //   4c895c2420           | mov                 eax, dword ptr [ebx + 0x1bc]

        $sequence_4 = { 488b5020 498b4c2420 488b12 488b09 e8???????? 488b4b20 e8???????? }
            // n = 7, score = 100
            //   488b5020             | inc                 ecx
            //   498b4c2420           | cmp                 esi, ebp
            //   488b12               | jle                 0x1fd2
            //   488b09               | dec                 eax
            //   e8????????           |                     
            //   488b4b20             | mov                 ebx, eax
            //   e8????????           |                     

        $sequence_5 = { 41be01000000 4983c404 4585ff 753b 833f06 7536 }
            // n = 6, score = 100
            //   41be01000000         | je                  0xe91
            //   4983c404             | dec                 eax
            //   4585ff               | mov                 ebx, eax
            //   753b                 | dec                 eax
            //   833f06               | cmp                 ebx, dword ptr [esi + 8]
            //   7536                 | jne                 0xc59

        $sequence_6 = { 488d8fd8010000 e8???????? 4c8b9ff0010000 4c019fd8010000 488d8fe0010000 e8???????? 4c8b9f00020000 }
            // n = 7, score = 100
            //   488d8fd8010000       | jle                 0x2cf
            //   e8????????           |                     
            //   4c8b9ff0010000       | inc                 ebp
            //   4c019fd8010000       | xor                 eax, eax
            //   488d8fe0010000       | dec                 eax
            //   e8????????           |                     
            //   4c8b9f00020000       | mov                 edx, ebx

        $sequence_7 = { 498bcc e8???????? 488d8c2400010000 e8???????? 85c0 0f8536010000 0fb64662 }
            // n = 7, score = 100
            //   498bcc               | dec                 eax
            //   e8????????           |                     
            //   488d8c2400010000     | arpl                dx, cx
            //   e8????????           |                     
            //   85c0                 | xor                 edx, edx
            //   0f8536010000         | inc                 ebp
            //   0fb64662             | lea                 eax, [esi + 1]

        $sequence_8 = { 48c1e83f 4803d0 483bd3 737e 488bd3 488d4f18 e8???????? }
            // n = 7, score = 100
            //   48c1e83f             | jne                 0xa4
            //   4803d0               | dec                 eax
            //   483bd3               | inc                 ecx
            //   737e                 | dec                 ecx
            //   488bd3               | lea                 eax, [eax + ecx]
            //   488d4f18             | dec                 eax
            //   e8????????           |                     

        $sequence_9 = { 4c8be8 4c2beb 0f8478010000 80383b 0f846f010000 41be01000000 4c8d256e890100 }
            // n = 7, score = 100
            //   4c8be8               | inc                 ecx
            //   4c2beb               | and                 eax, ecx
            //   0f8478010000         | inc                 ecx
            //   80383b               | and                 edx, ecx
            //   0f846f010000         | inc                 ecx
            //   41be01000000         | mov                 ecx, ecx
            //   4c8d256e890100       | inc                 esp

    condition:
        7 of them and filesize < 742400
}